\documentclass[12pt,letterpaper]{article}

\newcommand{\TT}{{\!\mathsf{T}}}
\newcommand{\given}{\,|\,}

\begin{document}

\section*{to Adrian from Hogg}

Right now, I believe that you do \emph{something} like:
\begin{quote}
For each star,
evolve it's phase-space position $X$ (a 6-vector) backwards in time $t$.
Find the time $t_0$ at which it's 6-space distance $\Delta_0$ from the progenitor is minimized.
Compute the empirical variance tensor $V$ by taking the mean outer product $\Delta_0\cdot \Delta_0^\TT$.
Use $\ln\det V$ as the scalar objective by which different potentials are compared.
\end{quote}
I am not sure if this summary is correct.
For example, in the code snippet you tweeted, you are subtracting a mean from the 6-displacements.
That implies that perhaps you don't know where the progenitor really is?
But if so, then how do you find the time $t_0$ at which 6-displacement is minimized?

Here's my proposal.
All I have to give you is a likelihood function%
---a probability for the data given parameters---%
and you can take it from there.
Let me know if you want help with priors or sampling.
I don't think this model would be hard to instantiate or sample.
But it \emph{does} have a lot of nuisance parameters (one per star plus some extras).

The progenitor has a 6-space position $X_p(t)$ which is time-dependent and potential-dependent.
In addition to the potential parameters $\phi$
there are 6 free parameters $\omega$ in the progenitor initial conditions (or orbit specification).
In addition, the progenitor has an associated variance tensor $V$,
which can be a general $6\times 6$ symmetric positive definite tensor or it can be required to be diagonal.
I would suggest not only making it diagonal but making the spatial part and velocity part each be spherical
(so it is specified by only two scalars: a spatial scale and a velocity scale).

Each star $i$ has a \emph{perfectly measured} phase-space position $X_i(0)$ right now,
and (given potential parameters $\phi$) can be integrated back in time to give any 6-position $X_i(t)$ in the past.
Each star has a latent parameter $t_i$,
which is the time at which it is considered to have departed the satellite.
The likelihood is the evaluation of the Gaussian centered on the progenitor for each star at position $X_i(t_i)$;
that is:
\begin{eqnarray}
p(d\given \phi,\omega,V,t_i) &=& N(y\given m,V)
\\
d &\equiv& X_i(0)
\\
y &\equiv& X_i(t_i)
\\
m &\equiv& X_p(t_i)
\quad ,
\end{eqnarray}
where
$N(y\given m,V)$ is the 6-dimensional Gaussian in $y$ with mean $m$ and variance tensor $V$,
$d$ is the observed data point (a star's 6-vector position),
$y$ is the 6-position of the star at past time $t_i$,
and $m$ is the 6-position of the progenitor at that same time.

[drops the mic]

\end{document}


